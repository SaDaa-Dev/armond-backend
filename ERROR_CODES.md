# 에러 코드 가이드

## 개요
이 문서는 Armond 백엔드 시스템에서 사용되는 모든 에러 코드를 정리한 문서입니다.
프론트엔드 개발자와 백엔드 개발자가 에러 처리를 위해 참조할 수 있습니다.

## 에러 응답 구조

```json
{
    "status": "fail|error|success",
    "message": "사용자용 메시지",
    "data": null,
    "error": "상세 오류 내용",
    "errorCode": "ERROR_CODE"
}
```

## HTTP 상태 코드 가이드라인

| HTTP 코드 | 용도 | 설명 |
|-----------|------|------|
| 400 | Bad Request | 클라이언트 요청 오류 (잘못된 입력, 검증 실패) |
| 401 | Unauthorized | 인증 실패 (로그인 필요, 잘못된 인증 정보) |
| 403 | Forbidden | 권한 부족 (인증됐지만 접근 권한 없음) |
| 404 | Not Found | 리소스 없음 |
| 409 | Conflict | 리소스 충돌 (중복 데이터 등) |
| 500 | Internal Server Error | 서버 내부 오류 |
| 503 | Service Unavailable | 서비스 이용 불가 (점검 등) |

## 에러 코드 목록

### 🔐 인증 관련 에러 (AUTH)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| AUTH_001 | 401 | 사용자를 찾을 수 없습니다 | 존재하지 않는 사용자로 로그인 시도 |
| AUTH_002 | 401 | 아이디 또는 비밀번호가 올바르지 않습니다 | 잘못된 인증 정보 |
| AUTH_003 | 500 | 토큰 생성에 실패했습니다 | 서버 측 토큰 생성 오류 |
| AUTH_004 | 401 | 유효하지 않은 토큰입니다 | 손상되거나 잘못된 토큰 |
| AUTH_005 | 401 | 만료된 토큰입니다 | 토큰 유효기간 만료 |
| AUTH_006 | 401 | 리프레시 토큰을 찾을 수 없습니다 | 리프레시 토큰 없음 |
| AUTH_007 | 401 | 리프레시 토큰이 일치하지 않습니다 | 리프레시 토큰 불일치 |

**프론트엔드 처리 예시:**
```javascript
switch(errorCode) {
    case 'AUTH_001':
    case 'AUTH_002':
        showError('아이디 또는 비밀번호를 확인해주세요');
        break;
    case 'AUTH_004':
    case 'AUTH_005':
        // 토큰 만료, 자동 로그아웃 처리
        logout();
        redirectToLogin();
        break;
    case 'AUTH_003':
        showError('서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요');
        break;
}
```

### ✅ 입력 검증 관련 에러 (VALIDATION)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| VALID_001 | 400 | 입력 검증에 실패했습니다 | 일반적인 검증 오류 |
| VALID_002 | 400 | 필수 입력값이 누락되었습니다 | 필수 필드 누락 |
| VALID_003 | 400 | 입력값 형식이 올바르지 않습니다 | 형식 오류 |
| VALID_004 | 400 | 전화번호 형식이 올바르지 않습니다 | 전화번호 형식 오류 |
| VALID_005 | 400 | 비밀번호가 보안 요구사항을 만족하지 않습니다 | 약한 비밀번호 |

### 👤 회원 관리 관련 에러 (MEMBER)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| MEMBER_001 | 409 | 이미 등록된 회원입니다 | 중복 회원가입 시도 |
| MEMBER_002 | 409 | 이미 사용 중인 닉네임입니다 | 닉네임 중복 |
| MEMBER_003 | 409 | 이미 사용 중인 이메일입니다 | 이메일 중복 |
| MEMBER_004 | 409 | 이미 사용 중인 전화번호입니다 | 전화번호 중복 |
| MEMBER_005 | 404 | 회원 정보를 찾을 수 없습니다 | 존재하지 않는 회원 |
| MEMBER_006 | 403 | 비활성화된 회원입니다 | 계정 비활성화 상태 |

### 🏃‍♂️ 운동 관련 에러 (WORKOUT)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| WORKOUT_001 | 404 | 운동 정보를 찾을 수 없습니다 | 존재하지 않는 운동 기록 |
| WORKOUT_002 | 400 | 이미 완료된 운동입니다 | 중복 완료 시도 |
| WORKOUT_003 | 400 | 유효하지 않은 운동 세트입니다 | 잘못된 세트 정보 |

### 📝 루틴 관련 에러 (ROUTINE)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| ROUTINE_001 | 404 | 루틴을 찾을 수 없습니다 | 존재하지 않는 루틴 |
| ROUTINE_002 | 403 | 루틴에 접근할 권한이 없습니다 | 권한 부족 |
| ROUTINE_003 | 409 | 이미 사용 중인 루틴 이름입니다 | 루틴명 중복 |

### 💪 운동 종목 관련 에러 (EXERCISE)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| EXERCISE_001 | 404 | 운동 종목을 찾을 수 없습니다 | 존재하지 않는 운동 종목 |
| EXERCISE_002 | 404 | 운동 부위 정보를 찾을 수 없습니다 | 존재하지 않는 운동 부위 |

### ⚙️ 시스템 에러 (SYSTEM)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| SYS_001 | 500 | 서버 내부 오류가 발생했습니다 | 일반적인 서버 오류 |
| SYS_002 | 500 | 데이터베이스 오류가 발생했습니다 | DB 연결/쿼리 오류 |
| SYS_003 | 500 | 외부 API 호출에 실패했습니다 | 외부 서비스 오류 |
| SYS_004 | 500 | 파일 업로드에 실패했습니다 | 파일 처리 오류 |
| SYS_005 | 503 | 시스템 점검 중입니다 | 점검/유지보수 |

### 🔧 일반적인 에러 (COMMON)

| 에러 코드 | HTTP | 메시지 | 설명 |
|-----------|------|--------|------|
| COMMON_001 | 500 | 예기치 못한 오류가 발생했습니다 | 예상치 못한 RuntimeException |
| COMMON_002 | 400 | 잘못된 요청입니다 | 일반적인 BadRequest |
| COMMON_003 | 403 | 접근이 거부되었습니다 | 일반적인 Forbidden |
| COMMON_004 | 404 | 요청한 리소스를 찾을 수 없습니다 | 일반적인 NotFound |

## 에러 코드 네이밍 규칙

### 1. 구조
```
[카테고리]_[번호]
```

### 2. 카테고리 분류
- **AUTH**: 인증/인가 관련
- **VALID**: 입력 검증 관련  
- **MEMBER**: 회원 관리 관련
- **WORKOUT**: 운동 기록 관련
- **ROUTINE**: 루틴 관리 관련
- **EXERCISE**: 운동 종목 관련
- **SYS**: 시스템 레벨 오류
- **COMMON**: 일반적인 오류

### 3. 번호 부여 규칙
- 001부터 시작
- 카테고리별로 순차 증가
- 3자리 패딩 (001, 002, 003...)

## 개발자 가이드

### 새로운 에러 코드 추가 방법

1. **ErrorCode enum에 추가**
   ```java
   // src/main/java/com/dev/armond/common/enums/ErrorCode.java
   NEW_CATEGORY_ERROR("NEW_001", "에러 메시지", 400)
   ```

2. **커스텀 Exception 클래스 생성** (필요시)
   ```java
   public class NewException extends RuntimeException {
       // ErrorCode를 사용하는 구조로 구현
   }
   ```

3. **GlobalRestExceptionHandler에 핸들러 추가** (필요시)
   ```java
   @ExceptionHandler(NewException.class)
   public ResponseEntity<ApiResponse<Object>> handleNewException(NewException e) {
       // 에러 처리 로직
   }
   ```

4. **이 문서 업데이트**
   - 해당 카테고리에 새 에러 코드 추가
   - 프론트엔드 처리 예시 업데이트 (필요시)

### 에러 로깅 가이드

- **401, 400 에러**: WARN 레벨로 로깅
- **500 에러**: ERROR 레벨로 로깅  
- **스택 트레이스**: 500 에러에만 포함

### 프론트엔드 연동 가이드

1. **에러 코드 기반 분기 처리**
   ```javascript
   if (response.errorCode?.startsWith('AUTH_')) {
       // 인증 관련 에러 처리
   } else if (response.errorCode?.startsWith('VALID_')) {
       // 검증 에러 처리
   }
   ```

2. **사용자 친화적 메시지 표시**
   - 기본적으로 `response.message` 사용
   - 필요시 `errorCode`에 따라 커스텀 메시지 표시

3. **에러 상태별 UI 처리**
   - 401: 로그인 페이지로 리다이렉트
   - 403: 권한 없음 페이지 표시
   - 500: 일반적인 오류 메시지와 재시도 버튼

## 버전 히스토리

| 버전 | 날짜 | 변경사항 |
|------|------|----------|
| 1.0.0 | 2024-01-XX | 초기 에러 코드 시스템 구축 |

---

📝 **문서 관리**: 새로운 에러 코드 추가 시 반드시 이 문서를 업데이트해주세요.  
🔄 **정기 검토**: 분기별로 사용되지 않는 에러 코드 정리 및 통합을 진행합니다. 